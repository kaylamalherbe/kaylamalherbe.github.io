# METR4201 AAP3
## Task 1
a) 

![Freebody Diagram A](/images/FreeBody1.png)

Equation of motion from free body diagram:

$$ m\ddot{y} = k(x-y) + c(\dot{x} - \dot{y}$$
Apply Laplance
$$ ms^2 Y(s) = k(X(s) - Y(s)) + c(sX(s) - sY(s)) $$
$$ (ms^2 + cs + k) Y(s) = (cs + k) X(s) $$
$$ \frac{Y(s)}{X(s)} = \frac{cs + k}{ms^2 + cs + k} $$

b)

![Freebody Diagram B](/images/FreeBody2.png)

Equation of motion from free body diagram:

$$ m\ddot{y} = k(x-y) - c(\dot{y} $$
Apply Laplace
$$ ms^2 Y(s) = k(X(s) - Y(s)) - c(sY(s)) $$
$$ (ms^2 + cs + k) Y(s) = kX(s) $$ 
$$ \frac{Y(s)}{X(s)} = \frac{k}{ms^2 + cs + k} $$

## Task 2
a) 
![(a) PID in Forward Path](/images/block_diagram_a.png)

Using block diagram rules to reduce the feedback loop

$$ A = (K_p + \frac{K_i}{s} + K_d s)(K_{HW}(\frac{1}{ms^2})  $$
$$ A = = (K_d s^2 + K_ps + K_i)(K_{HW})(\frac{1}{ms^3}) $$
$$ B = 1 $$
$$ \frac{A}{1 + B} = \frac{(K_d s^2 + K_ps + K_i)(K_{HW})(\frac{1}{ms^3})}{1 + (K_d s^2 + K_ps + K_i + )(K_{HW})(\frac{1}{ms^3})} $$
$$ \frac{X(s)}{R(X)} = \frac{K_dK_{HW} s^2 + K_psK_{HW} + K_iK_{HW}}{ms^3 + K_dK_{HW} s^2 + K_psK_{HW} + K_iK_{HW}} $$

b)
![(b) PI in Forward Path, D in the return path](/images/block_diagram_b.png)
There are two feedback loops in block diagram b)
![(b) Reduced to show two feedback loops](/images/block_diagram_b2.png)

Reducing Feedback loop 1 with block diagram rules:

$$ A = \frac{K_{HW}}{ms^2}  $$
$$ B = K_ds $$
$$ \frac{A}{1 + B} = \frac{\frac{K_{HW}}{ms^2}}{1 + (\frac{K_{HW}}{ms^2})(K_ds)} $$
$$ \frac{A}{1 + B} = \frac{K_{HW}}{ms^2 + K_{HW}K_ds} $$

![(b) Reduced to remove first feedback loop](/images/block_diagram_b3.png)

Reducing Last feedback loop:

$$ A = (K_p + \frac{K_i}{s}) (\frac{K_{HW}}{ms^2 + K_{HW}K_ds}) $$
$$ A = (K_ps + K_i) (\frac{K_{HW}}{ms^3 + K_{HW}K_ds^2}) $$
$$ B = 1 $$
$$ \frac{A}{1 + B} = \frac{(K_ps + K_i) (\frac{K_{HW}}{ms^3 + K_{HW}K_ds^2})}{1 + (K_ps + K_i) (\frac{K_{HW}}{ms^3 + K_{HW}K_ds^2})}$$
$$ \frac{X(s)}{R(s)} = \frac{(K_ps + K_i)K_{HW}}{ms^3 + K_{HW}K_ds^2 + (K_ps + K_i)K_{HW}} $$
$$ \frac{X(s)}{R(s)} = \frac{K_pK_{HW}s + K_iK_{HW}}{ms^3 + K_{HW}K_ds^2 + K_pK_{HW}s + K_iK_{HW}} $$

## Task 3

Equation 1a

$$ \frac{Y(s)}{X(s)} = \frac{cs + k}{ms^2 + cs + k} $$

Equation 2a

$$ \frac{X(s)}{R(X)} = \frac{K_dK_{HW} s^2 + K_psK_{HW} + K_iK_{HW}}{ms^3 + K_dK_{HW} s^2 + K_psK_{HW} + K_iK_{HW}} $$
$$ K_i = 0 $$
$$ \frac{X(s)}{R(X)} = \frac{K_dK_{HW} s^2 + K_psK_{HW}}{ms^3 + K_dK_{HW} s^2 + K_psK_{HW}} $$
$$ \frac{X(s)}{R(X)} = \frac{K_dK_{HW} s + K_pK_{HW}}{ms^2 + K_dK_{HW} s + K_pK_{HW}} $$

$$ \frac{Y(s)}{X(s)} = \frac{X(s)}{R(X)} $$
$$ \frac{cs + k}{ms^2 + cs + k} = \frac{K_dK_{HW} s + K_pK_{HW}}{ms^2 + K_dK_{HW} s + K_pK_{HW}} $$

Compare coefficients between Equation 1a and Equation 2a

$$ c = K_dK_{HW} $$
$$ k = K_pK_{HW} $$

Equation 1b

$$ \frac{Y(s)}{X(s)} = \frac{k}{ms^2 + cs + k} $$

Equation 2b
$$ \frac{X(s)}{R(s)} = \frac{K_pK_{HW}s + K_iK_{HW}}{ms^3 + K_{HW}K_ds^2 + K_pK_{HW}s + K_iK_{HW}} $$
$$ K_i = 0 $$
$$ \frac{X(s)}{R(s)} = \frac{K_pK_{HW}s}{ms^3 + K_{HW}K_ds^2 + K_pK_{HW}s}} $$
$$ \frac{X(s)}{R(s)} = \frac{K_pK_{HW}}{ms^2 + K_{HW}K_ds + K_pK_{HW}}} $$

$$ \frac{Y(s)}{X(s)} = \frac{X(s)}{R(X)} $$
$$ \frac{k}{ms^2 + cs + k} = \frac{K_pK_{HW}}{ms^2 + K_{HW}K_ds + K_pK_{HW}} $$

Equation coefficients between Equation 1b and Equation 2b

$$ c = K_dK_{HW} $$
$$ k = K_pK_{HW} $$

Consistent with part a comparison.

## Task 4
Simulink model for Figure A:

![Simulink Model for System A](/images/Simulink_model_A.png)
![Simulink Output Graph for System A](/images/Simulink_graph_A.png)

![Simulink Model for System B](/images/Simulink_model_B.png)
![Simulink Output Graph for System B](/images/Simulink_graph_B.png)


The overshoot for Model A is higher than Model B but the rise and settling times are the same. The lower overshoot in Model B could be because of the direct feedback including the Derivative component (D) leading to direct dampening of the output therefore reducing the overshoot faster than in Model A.

A regulator with a set point would want to return to that set point as smoothly as possible therefore the regulator would use Method B because it has less overshoot so when responding to a step change it will be less likely to trip a fault and cause additional issues. 
The preference for a system to respond with the fastest settling time and lowest overshoot possible.

## Task 5






